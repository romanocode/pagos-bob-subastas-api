// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

// Eliminar output   = "../generated/prisma"
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


model Subastas{
  id     Int      @id @default(autoincrement())
  titulo        String
  imgSubasta    String?
  placaVehiculo String
  empresa       String
  fecha         DateTime
  moneda        String
  monto         Decimal
  descripcion   String?
  estado        String
  createdAt     DateTime @default(now())
  updatedAt     DateTime?
  canceledAt    DateTime?

  garantias        Garantias[]
  facturaciones     Facturacion[]
}

model Clientes {
  id        Int      @id @default(autoincrement())
  correo            String
  nombreCompleto    String
  tipDocumento     String
  numDocumento     String
  numCelular       String
  saldoTotalDolar  Decimal    @default(0)
  activo           Boolean    @default(true)
  createdAt        DateTime    @default(now())
  updatedAt        DateTime?
  canceledAt       DateTime?

  garantias        Garantias[]
  reembolsos        Reembolsos[]
  facturaciones     Facturacion[]
}

model Garantias {
  id        Int      @id @default(autoincrement())
  idSubasta         Int
  idCliente         Int
  concepto          String
  fechaSubasta      DateTime
  fechaExpiracion   DateTime
  tipo              String
  moneda            String
  porcentaje        Decimal
  montoPuja         Decimal
  montoGarantia     Decimal
  banco             String
  numCuentaDeposito String
  docAdjunto        String
  dtFacRuc         String
  dtFacRazonSocial String
  comentarios       String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime?
  sentedAt          DateTime?
  validatedAt       DateTime?
  invalidatedAt     DateTime?
  revokedAt         DateTime?

  subasta           Subastas @relation(fields: [idSubasta], references: [id])
  cliente           Clientes @relation(fields: [idCliente], references: [id])
}

model Reembolsos{
  id       Int      @id @default(autoincrement())
  idCliente         Int
  monto             Decimal
  banco             String
  numCuentaDeposito String
  docAdjunto        String?
  comentarios       String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime?
  validatedAt       DateTime?
  revokedAt         DateTime?

  cliente           Clientes @relation(fields: [idCliente], references: [id])
}

model Facturacion{
  id     Int      @id @default(autoincrement())
  idCliente         Int
  idSubasta         Int
  monto             Decimal
  banco             String
  numCuentaDeposito String
  docAdjunto        String?
  concepto          String
  comentarios       String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime?
  validatedAt       DateTime?
  revokedAt         DateTime?

  subasta           Subastas @relation(fields: [idSubasta], references: [id])
  cliente           Clientes @relation(fields: [idCliente], references: [id])
}

